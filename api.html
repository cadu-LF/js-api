<!-- o servidor http recebe uma requisição http, vai no banco de dados
    e devolve uma resposta http -->
<!-- a requisição é feita com o comando .open para abrir a requisição, o .send() para mandar a requisição
para o servidor e o .onload() devolve a resposta do servidor -->
<!-- a api pode ser usado para dar a resposta para softwares nas mais diversas aplicações -->
<!-- api ajuda a melhorar a segurança, pq não se enntra diretamente no banco de dados -->

<!-- http://www.omdbapi.com -->
<!-- api key: 7d2417b1-->

<!--{"Title":"Joker",
    "Year":"2019",
    "Rated":"R",
    "Released":"04 Oct 2019",
    "Runtime":"122 min",
    "Genre":"Crime, Drama, Thriller",
    "Director":"Todd Phillips",
    "Writer":"Todd Phillips, Scott Silver, Bob Kane (based on characters created by), Bill Finger (based on characters created by), Jerry Robinson (based on characters created by)",
    "Actors":"Joaquin Phoenix, Robert De Niro, Zazie Beetz, Frances Conroy",
    "Plot":"In Gotham City, mentally troubled comedian Arthur Fleck is disregarded and mistreated by society. He then embarks on a downward spiral of revolution and bloody crime. This path brings him face-to-face with his alter-ego: the Joker.",
    "Language":"English",
    "Country":"USA, Canada",
    "Awards":"Won 2 Oscars. Another 104 wins & 218 nominations.",
    "Poster":"https://m.media-amazon.com/images/M/MV5BNGVjNWI4ZGUtNzE0MS00YTJmLWE0ZDctN2ZiYTk2YmI3NTYyXkEyXkFqcGdeQXVyMTkxNjUyNQ@@._V1_SX300.jpg"
}
-->
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
        <script>
            function consomeApi() {
                let nome = document.getElementById('nome').value
                let req = new XMLHttpRequest()
                let url = `http://www.omdbapi.com/?t=${nome}&apikey=7d2417b1`
                req.open('GET', url, true)
                req.send()
                req.onload = () => {
                    let resp = JSON.parse(req.responseText)
                    if((req.readyState == 4) && (req.status == 200)){
                        document.getElementById('title').innerHTML = resp.Title
                        document.getElementById('year').innerHTML = resp.Year
                        document.getElementById('rated').innerHTML = resp.Rated
                        document.getElementById('release').innerHTML = resp.Released
                        document.getElementById('time').innerHTML = resp.Runtime
                        document.getElementById('genre').innerHTML = resp.Genre
                        document.getElementById('direction').innerHTML = resp.Director
                        document.getElementById('writer').innerHTML = resp.Writer
                        document.getElementById('actor').innerHTML = resp.Actors
                        document.getElementById('plot').innerHTML = resp.Plot
                        document.getElementById('lingua').innerHTML = resp.Language
                        document.getElementById('pais').innerHTML = resp.Country
                        document.getElementById('prices').innerHTML = resp.Awards
                        document.getElementById('poster').src = resp.Poster
                    }
                    else{
                        alert('Item não encontrado')
                    }
                }
            }
        </script>
    </head>
    <body>
        <!-- container é um classe do bootstrap -->
        <div class = 'container'>
            <form class = "form-group">
                <label>Título do filme</label>
                <input class="form-control" id="nome"/>
            </form>
        </div>
        <div class = 'form-group'>
            <button type = 'button' onclick = 'consomeApi()' class="btn btn-primary">OK</button>
        </div>
        <div class = 'form-group'>
            Título: <h2 id = 'title'></h2>
            Ano: <h3 id = 'year'></h3>
            Classificação: <h3 id = 'rated'></h3>
            Data de lançamento: <h3 id = 'release'></h3>
            Duração: <h3 id = 'time'></h3>
            Gênero: <h3 id = 'genre'></h3>
            Direitores: <h3 id = 'direction'></h3>
            Escritor: <h3 id = 'writer'></h3>
            Atores: <h3 id = 'actor'></h3>
            Resumo: <h3 id = 'plot'></h3>
            Idioma original: <h3 id = 'lingua'></h3>
            País: <h3 id = 'pais'></h3>
            Premios: <h3 id = 'prices'></h3>
            Poster: <br> <img id = 'poster'/>
        </div>
    </body>
</html>